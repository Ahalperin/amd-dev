

1) protocols:
1.1)simple
mpirun -H 172.30.160.200:8,172.30.160.130:8  --mca oob_tcp_if_include enp81s0f1np1 --mca btl_tcp_if_include enp81s0f1np1 -np 16 bash -c " \
NCCL_DEBUG_SUBSYS=ALL \
NCCL_DEBUG=TRACE \
NCCL_DEBUG_FILE=nccl_debug.log \
NCCL_TOPO_DUMP_FILE=topo.xml \
NCCL_GRAPH_DUMP_FILE=graph.xml \
NCCL_PROTO=Simple \
LD_LIBRARY_PATH=/home/dn/amd-dev/amd/rccl/build/release:\$LD_LIBRARY_PATH \
HIP_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 \
/home/dn/amd-dev/amd/rccl-tests/build/all_reduce_perf -b 4 -e 8G -f 2 -g 1"
1.2)ll
mpirun -H 172.30.160.200:8,172.30.160.130:8  --mca oob_tcp_if_include enp81s0f1np1 --mca btl_tcp_if_include enp81s0f1np1 -np 16 bash -c " \
NCCL_DEBUG_SUBSYS=ALL \
NCCL_DEBUG=TRACE \
NCCL_DEBUG_FILE=nccl_debug.log \
NCCL_TOPO_DUMP_FILE=topo.xml \
NCCL_GRAPH_DUMP_FILE=graph.xml \
NCCL_PROTO=LL \
LD_LIBRARY_PATH=/home/dn/amd-dev/amd/rccl/build/release:\$LD_LIBRARY_PATH \
HIP_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 \
/home/dn/amd-dev/amd/rccl-tests/build/all_reduce_perf -b 4 -e 8G -f 2 -g 1"
1.3)ll128
mpirun -H 172.30.160.200:8,172.30.160.130:8  --mca oob_tcp_if_include enp81s0f1np1 --mca btl_tcp_if_include enp81s0f1np1 -np 16 bash -c " \
NCCL_DEBUG_SUBSYS=ALL \
NCCL_DEBUG=TRACE \
NCCL_DEBUG_FILE=nccl_debug.log \
NCCL_TOPO_DUMP_FILE=topo.xml \
NCCL_GRAPH_DUMP_FILE=graph.xml \
NCCL_PROTO=LL128 \
LD_LIBRARY_PATH=/home/dn/amd-dev/amd/rccl/build/release:\$LD_LIBRARY_PATH \
HIP_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 \
/home/dn/amd-dev/amd/rccl-tests/build/all_reduce_perf -b 4 -e 8G -f 2 -g 1"

2) algorithms
2.1) Ring
mpirun -H 172.30.160.200:8,172.30.160.130:8  --mca oob_tcp_if_include enp81s0f1np1 --mca btl_tcp_if_include enp81s0f1np1 -np 16 bash -c " \
NCCL_DEBUG_SUBSYS=ALL \
NCCL_DEBUG=TRACE \
NCCL_DEBUG_FILE=nccl_debug.log \
NCCL_TOPO_DUMP_FILE=topo.xml \
NCCL_GRAPH_DUMP_FILE=graph.xml \
NCCL_ALGO=Ring \
LD_LIBRARY_PATH=/home/dn/amd-dev/amd/rccl/build/release:\$LD_LIBRARY_PATH \
HIP_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 \
/home/dn/amd-dev/amd/rccl-tests/build/all_reduce_perf -b 4 -e 8G -f 2 -g 1"
2.2) Tree
mpirun -H 172.30.160.200:8,172.30.160.130:8  --mca oob_tcp_if_include enp81s0f1np1 --mca btl_tcp_if_include enp81s0f1np1 -np 16 bash -c " \
NCCL_DEBUG_SUBSYS=ALL \
NCCL_DEBUG=TRACE \
NCCL_DEBUG_FILE=nccl_debug.log \
NCCL_TOPO_DUMP_FILE=topo.xml \
NCCL_GRAPH_DUMP_FILE=graph.xml \
NCCL_ALGO=Tree \
LD_LIBRARY_PATH=/home/dn/amd-dev/amd/rccl/build/release:\$LD_LIBRARY_PATH \
HIP_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 \
/home/dn/amd-dev/amd/rccl-tests/build/all_reduce_perf -b 4 -e 8G -f 2 -g 1"
2.3)Collnet
mpirun -H 172.30.160.200:8,172.30.160.130:8  --mca oob_tcp_if_include enp81s0f1np1 --mca btl_tcp_if_include enp81s0f1np1 -np 16 bash -c " \
NCCL_DEBUG_SUBSYS=ALL \
NCCL_DEBUG=TRACE \
NCCL_DEBUG_FILE=nccl_debug.log \
NCCL_TOPO_DUMP_FILE=topo.xml \
NCCL_GRAPH_DUMP_FILE=graph.xml \
NCCL_ALGO=Collnet \
LD_LIBRARY_PATH=/home/dn/amd-dev/amd/rccl/build/release:\$LD_LIBRARY_PATH \
HIP_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 \
/home/dn/amd-dev/amd/rccl-tests/build/all_reduce_perf -b 4 -e 8G -f 2 -g 1"
2.4)CollnetChain
mpirun -H 172.30.160.200:8,172.30.160.130:8  --mca oob_tcp_if_include enp81s0f1np1 --mca btl_tcp_if_include enp81s0f1np1 -np 16 bash -c " \
NCCL_DEBUG_SUBSYS=ALL \
NCCL_DEBUG=TRACE \
NCCL_DEBUG_FILE=nccl_debug.log \
NCCL_TOPO_DUMP_FILE=topo.xml \
NCCL_GRAPH_DUMP_FILE=graph.xml \
NCCL_ALGO=CollnetChain \
LD_LIBRARY_PATH=/home/dn/amd-dev/amd/rccl/build/release:\$LD_LIBRARY_PATH \
HIP_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 \
/home/dn/amd-dev/amd/rccl-tests/build/all_reduce_perf -b 4 -e 8G -f 2 -g 1"
2.5)CollnetDirect
mpirun -H 172.30.160.200:8,172.30.160.130:8  --mca oob_tcp_if_include enp81s0f1np1 --mca btl_tcp_if_include enp81s0f1np1 -np 16 bash -c " \
NCCL_DEBUG_SUBSYS=ALL \
NCCL_DEBUG=TRACE \
NCCL_DEBUG_FILE=nccl_debug.log \
NCCL_TOPO_DUMP_FILE=topo.xml \
NCCL_GRAPH_DUMP_FILE=graph.xml \
NCCL_ALGO=CollnetDirect \
LD_LIBRARY_PATH=/home/dn/amd-dev/amd/rccl/build/release:\$LD_LIBRARY_PATH \
HIP_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 \
/home/dn/amd-dev/amd/rccl-tests/build/all_reduce_perf -b 4 -e 8G -f 2 -g 1"
2.6)PAT
mpirun -H 172.30.160.200:8,172.30.160.130:8  --mca oob_tcp_if_include enp81s0f1np1 --mca btl_tcp_if_include enp81s0f1np1 -np 16 bash -c " \
NCCL_DEBUG_SUBSYS=ALL \
NCCL_DEBUG=TRACE \
NCCL_DEBUG_FILE=nccl_debug.log \
NCCL_TOPO_DUMP_FILE=topo.xml \
NCCL_GRAPH_DUMP_FILE=graph.xml \
NCCL_ALGO=PAT \
LD_LIBRARY_PATH=/home/dn/amd-dev/amd/rccl/build/release:\$LD_LIBRARY_PATH \
HIP_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 \
/home/dn/amd-dev/amd/rccl-tests/build/all_reduce_perf -b 4 -e 8G -f 2 -g 1"
3)pxn
3.1)enable
mpirun -H 172.30.160.200:8,172.30.160.130:8  --mca oob_tcp_if_include enp81s0f1np1 --mca btl_tcp_if_include enp81s0f1np1 -np 16 bash -c " \
NCCL_DEBUG_SUBSYS=ALL \
NCCL_DEBUG=TRACE \
NCCL_DEBUG_FILE=nccl_debug.log \
NCCL_TOPO_DUMP_FILE=topo.xml \
NCCL_GRAPH_DUMP_FILE=graph.xml \
NCCL_PXN_DISABLE=0 \
LD_LIBRARY_PATH=/home/dn/amd-dev/amd/rccl/build/release:\$LD_LIBRARY_PATH \
HIP_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 \
/home/dn/amd-dev/amd/rccl-tests/build/all_reduce_perf -b 4 -e 8G -f 2 -g 1"
