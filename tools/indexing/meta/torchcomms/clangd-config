# clangd configuration for Meta TorchComms
# This file helps clangd understand the TorchComms codebase better
# Deploy this as .clangd in the TorchComms root directory

CompileFlags:
  # Treat CUDA files as C++
  Add:
    - "-xc++"
    - "-std=c++17"
    - "-ferror-limit=0"
    # CUDA/HIP related defines
    - "-D__CUDACC__"
    - "-D__CUDA_ARCH__=800"
    - "-D__HIP_PLATFORM_AMD__=1"
    - "-D__HIP_PLATFORM_HCC__=1"
    # Suppress warnings
    - "-Wno-unknown-cuda-version"
    - "-Wno-unknown-attributes"
    - "-Wno-cuda-compat"
    - "-Wno-ignored-attributes"
    - "-Wno-unused-function"
    - "-Wno-unused-variable"
    
  # Remove problematic flags
  Remove:
    - "-Werror"
    - "--expt-extended-lambda"
    - "-Xptxas*"
    - "-Xfatbin*"
    - "--cuda-gpu-arch=*"
    - "-fgpu-rdc"

Index:
  # Index in the background for better performance
  Background: Build
  
Diagnostics:
  # Suppress some diagnostics that don't make sense without full build
  Suppress:
    - "pp_file_not_found"
    - "drv_unknown_argument"
  ClangTidy:
    # Disable clang-tidy for faster indexing
    Add: []
    Remove: "*"
    
Hover:
  ShowAKA: Yes

InlayHints:
  Enabled: Yes
  ParameterNames: Yes
  DeducedTypes: Yes

