# clangd configuration for RCCL
# This file helps clangd understand the RCCL codebase better
# Deploy this as .clangd in the RCCL root directory

CompileFlags:
  # Treat all files as C++ (helps with .cu files)
  Add:
    - "-xc++"
    - "-std=c++17"
    - "-ferror-limit=0"
    # HIP/ROCm related defines
    - "-D__HIP_PLATFORM_AMD__=1"
    - "-D__HIP_PLATFORM_HCC__=1"
    - "-D__HIPCC__"
    - "-D__HIP_DEVICE_COMPILE__=0"
    # Suppress some common warnings in CUDA/HIP code
    - "-Wno-unknown-cuda-version"
    - "-Wno-unknown-attributes"
    - "-Wno-cuda-compat"
    - "-Wno-ignored-attributes"
    # Enable detailed macro expansion tracking for better indexing
    - "-fmacro-backtrace-limit=0"
    
  # Remove problematic flags that might confuse clangd
  Remove:
    - "-fgpu-rdc"
    - "--offload-arch=*"
    - "--offload-compress"
    - "-parallel-jobs=*"
    - "--hipcc-func-supp"
    - "-Werror"
    - "-Rpass-analysis=*"
    - "-mllvm"

Index:
  # Index in the background for better performance
  Background: Build
  # Enable standard library indexing for better cross-reference
  StandardLibrary: Yes
  
Diagnostics:
  # Suppress some diagnostics that don't make sense without full build
  Suppress:
    - "pp_file_not_found"
    - "drv_unknown_argument"
  ClangTidy:
    # Disable clang-tidy for faster indexing
    Add: []
    Remove: "*"
    
Hover:
  ShowAKA: Yes

InlayHints:
  Enabled: Yes
  ParameterNames: Yes
  DeducedTypes: Yes

Completion:
  AllScopes: Yes

SemanticTokens:
  DisabledKinds: []
  DisabledModifiers: []







